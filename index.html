<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, shrink-to-fit=no">
    <!-- SEO Meta Tags -->
    <title>Portal Berita Dinamis - Berita dan Opini Terkini</title>
    <meta name="description" content="Portal Berita Dinamis menyajikan berita nasional, daerah, dan opini terkini dari sumber terpercaya. Dapatkan informasi akurat dan terbaru setiap hari.">
    <meta name="keywords" content="berita, berita nasional, berita daerah, opini, portal berita, Indonesia, ekonomi, pendidikan, lifestyle">
    <meta name="robots" content="index, follow">
    <meta name="author" content="Portal Berita Dinamis">
    <!-- Open Graph Meta Tags -->
    <meta property="og:title" content="Portal Berita Dinamis - Berita dan Opini Terkini">
    <meta property="og:description" content="Dapatkan berita nasional, daerah, dan opini terpercaya di Portal Berita Dinamis. Informasi akurat dan terkini setiap hari.">
    <meta property="og:image" content="https://via.placeholder.com/1200x630?text=Portal+Berita+Dinamis">
    <meta property="og:url" content="https://yourdomain.com">
    <meta property="og:type" content="website">
    <!-- Twitter Card Meta Tags -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="Portal Berita Dinamis - Berita dan Opini Terkini">
    <meta name="twitter:description" content="Dapatkan berita nasional, daerah, dan opini terpercaya di Portal Berita Dinamis. Informasi akurat dan terkini setiap hari.">
    <meta name="twitter:image" content="https://via.placeholder.com/1200x630?text=Portal+Berita+Dinamis">
    <!-- Canonical URL -->
    <link rel="canonical" href="https://yourdomain.com">
    <!-- Sitemap and Robots -->
    <link rel="sitemap" href="/sitemap.xml">
    <!-- Favicon -->
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <!-- CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <link href="https://unpkg.com/aos@2.3.4/dist/aos.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.6.0/css/all.min.css" rel="stylesheet" integrity="sha512-Kc323vGBEqzTmouAECnVceyQqyqdsSiqLQISBL29aUW4U/M7pSPA/gEUZQqv1cwx4OnYxTxve5UMg5GT6L4JJg==" crossorigin="anonymous">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&display=swap" rel="stylesheet">
    <!-- Fallback CSS -->
    <link rel="stylesheet" href="/assets/bootstrap.min.css" onerror="this.onerror=null; this.href='/assets/bootstrap.min.css';">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f8f9fa;
            color: #000000; /* Warna font utama hitam */
            overflow-x: hidden;
            margin: 0;
        }
        .navbar {
            background-color: #ffffff;
            border-bottom: 1px solid #ddd;
            padding: 1rem 0;
            position: sticky;
            top: 0;
            z-index: 1000;
            transition: box-shadow 0.3s ease;
        }
        .navbar.scrolled {
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .nav-link {
            color: #007bff;
            font-weight: 500;
            transition: color 0.2s ease;
        }
        .nav-link:hover {
            color: #0056b3;
        }
        .dropdown-menu {
            background-color: #ffffff;
            border: 1px solid #ddd;
            border-radius: 4px;
        }
        .dropdown-item {
            color: #000000;
        }
        .dropdown-item:hover {
            background-color: #f8f9fa;
            color: #0056b3;
        }
        .dropdown-submenu {
            position: relative;
        }
        .dropdown-submenu .dropdown-menu {
            top: 0;
            left: 100%;
            margin-top: -1px;
        }
        .hero-section {
            background: url('https://via.placeholder.com/1200x200?text=Hero+Image') center/cover no-repeat;
            color: #ffffff;
            text-align: center;
            padding: 4rem 0;
            position: relative;
            overflow: hidden;
        }
        .hero-section h1 {
            font-size: 2.5rem;
            font-weight: 600;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
            color: #ffffff;
        }
        .hero-section p {
            font-size: 1.2rem;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.5);
            color: #ffffff;
        }
        .article-card {
            border: none;
            margin-bottom: 1.5rem;
            background-color: #ffffff;
            border-radius: 8px;
            padding: 1rem;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }
        .article-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.15);
        }
        .article-card img {
            max-width: 120px;
            height: auto;
            border-radius: 4px;
        }
        .footer {
            background-color: #ffffff;
            padding: 1rem 0;
            border-top: 1px solid #ddd;
            text-align: center;
            color: #333333; /* Warna font sekunder abu-abu gelap */
        }
        .error-message {
            text-align: center;
            color: #dc3545; /* Merah untuk error */
            padding: 1rem;
            font-weight: 500;
        }
        .loading-spinner {
            text-align: center;
            padding: 2rem;
            font-style: italic;
            color: #333333;
        }
        h1, h2, h3, h4, h5 {
            color: #000000; /* Warna font heading hitam */
            font-weight: 600;
        }
        label, p, .form-control, .btn {
            color: #000000; /* Warna font hitam untuk elemen UI */
        }
        .text-muted {
            color: #333333 !important; /* Warna font sekunder abu-abu gelap */
        }
        @media (max-width: 768px) {
            .navbar {
                padding: 0.5rem 0;
            }
            .hero-section {
                padding: 2rem 0;
            }
            .hero-section h1 {
                font-size: 1.8rem;
            }
            .hero-section p {
                font-size: 1rem;
            }
            .article-card {
                flex-direction: column;
            }
            .article-card img {
                max-width: 100%;
                margin-bottom: 0.5rem;
            }
            .form-control, .btn {
                font-size: 1rem;
                padding: 0.75rem;
            }
        }
        @media (max-width: 576px) {
            .article-card img {
                max-width: 100%;
            }
            .nav-link {
                font-size: 0.9rem;
            }
            .dropdown-menu {
                font-size: 0.9rem;
            }
        }
    </style>
</head>
<body>
    <nav class="navbar navbar-expand-lg" id="navbar">
        <div class="container">
            <a class="navbar-brand" href="/">Portal Berita</a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <div class="d-flex flex-column flex-lg-row gap-3 align-items-lg-center w-100">
                    <a href="#about" class="nav-link">About</a>
                    <a href="#home" class="nav-link">Beranda</a>
                    <div class="dropdown">
                        <a class="nav-link dropdown-toggle" href="#berita-pilihan" id="categoryDropdown" data-bs-toggle="dropdown" aria-expanded="false">Berita Pilihan</a>
                        <ul class="dropdown-menu" aria-labelledby="categoryDropdown">
                            <li class="dropdown-submenu">
                                <a class="dropdown-item dropdown-toggle" href="#" data-category="Nasional">Berita Nasional</a>
                                <ul class="dropdown-menu">
                                    <li><a class="dropdown-item" href="#" onclick="filterByCategory('Nasional', 'Ekonomi')">Ekonomi</a></li>
                                    <li><a class="dropdown-item" href="#" onclick="filterByCategory('Nasional', 'Pendidikan')">Pendidikan</a></li>
                                    <li><a class="dropdown-item" href="#" onclick="filterByCategory('Nasional', 'Lifestyle')">Lifestyle</a></li>
                                </ul>
                            </li>
                            <li class="dropdown-submenu">
                                <a class="dropdown-item dropdown-toggle" href="#" data-category="Daerah">Berita Daerah</a>
                                <ul class="dropdown-menu">
                                    <li><a class="dropdown-item" href="#" onclick="filterByCategory('Daerah', 'Ekonomi')">Ekonomi</a></li>
                                    <li><a class="dropdown-item" href="#" onclick="filterByCategory('Daerah', 'Pendidikan')">Pendidikan</a></li>
                                    <li><a class="dropdown-item" href="#" onclick="filterByCategory('Daerah', 'Lifestyle')">Lifestyle</a></li>
                                </ul>
                            </li>
                        </ul>
                    </div>
                    <a href="#opini" class="nav-link">Opini</a>
                    <form class="search-form d-flex ms-lg-auto">
                        <input type="text" class="form-control me-2" id="searchInput" placeholder="Cari berita..." aria-label="Cari berita">
                        <button type="submit" class="btn btn-primary btn-sm">Cari</button>
                    </form>
                </div>
            </div>
        </div>
    </nav>

    <section class="hero-section" id="home" data-aos="fade-up" data-aos-duration="1000">
        <div class="container">
            <h1>Portal Berita Dinamis</h1>
            <p>Berita dan opini terkini dari sumber terpercaya</p>
        </div>
    </section>

    <main class="container mt-4">
        <div id="error-message" class="error-message" style="display: none;"></div>

        <section id="berita-pilihan" class="mb-5" data-aos="fade-up" data-aos-duration="1000">
            <h2 class="h4 mb-3">Berita Pilihan</h2>
            <div id="article-list" class="loading-spinner">Memuat berita...</div>
            <nav aria-label="Pagination for Berita Pilihan">
                <ul class="pagination" id="pagination"></ul>
            </nav>
        </section>

        <section id="opini" class="mb-5" data-aos="fade-up" data-aos-duration="1000">
            <h2 class="h4 mb-3">Opini</h2>
            <div id="opini-list" class="loading-spinner">Memuat opini...</div>
            <nav aria-label="Pagination for Opini">
                <ul class="pagination" id="opini-pagination"></ul>
            </nav>
        </section>

        <section id="about" class="mb-5" data-aos="fade-up" data-aos-duration="1000">
            <h2 class="h4 mb-3">Tentang Kami</h2>
            <p class="text-muted">Portal Berita Dinamis menyajikan berita dan opini terkini dengan fokus pada keakuratan dan kebermanfaatan informasi. Kami berkomitmen untuk menjadi sumber terpercaya bagi pembaca. <a href="#home">Lihat berita terbaru</a>.</p>
        </section>
    </main>

    <footer class="footer" data-aos="fade-up" data-aos-duration="1000">
        <div class="container">
            <p class="mb-0">&copy; 2025 Portal Berita Dinamis. Hak cipta dilindungi. <a href="#about">Tentang Kami</a> | <a href="#home">Beranda</a></p>
        </div>
    </footer>

    <!-- Schema Markup -->
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "NewsMediaOrganization",
        "name": "Portal Berita Dinamis",
        "url": "https://yourdomain.com",
        "logo": "https://yourdomain.com/assets/logo.png",
        "description": "Portal Berita Dinamis menyajikan berita nasional, daerah, dan opini terkini dari sumber terpercaya.",
        "sameAs": [
            "https://twitter.com/yourprofile",
            "https://facebook.com/yourprofile"
        ]
    }
    </script>

    <script src="https://www.gstatic.com/firebasejs/10.14.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.14.0/firebase-firestore-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.14.0/firebase-storage-compat.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
    <script src="https://unpkg.com/aos@2.3.4/dist/aos.js"></script>
    <!-- Fallback JS -->
    <script src="/assets/bootstrap.bundle.min.js" onerror="this.onerror=null; this.src='/assets/bootstrap.bundle.min.js';"></script>
    <script src="/assets/aos.js" onerror="this.onerror=null; this.src='/assets/aos.js';"></script>
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            console.log('DOM loaded, initializing index page...');

            // Initialize Firebase
            const firebaseConfig = {
                apiKey: "AIzaSyDeh5U6XY3LB2WngKgBXxTZ1mKUC_tZffE",
                authDomain: "sumatrapost-2a629.firebaseapp.com",
                projectId: "sumatrapost-2a629",
                storageBucket: "sumatrapost-2a629.firebasestorage.app",
                messagingSenderId: "470408679333",
                appId: "1:470408679333:web:2787f03e2358a30e87e24c",
                measurementId: "G-DZ26JNMY9F"
            };

            let db;
            try {
                firebase.initializeApp(firebaseConfig);
                db = firebase.firestore();
                console.log('Firebase initialized successfully');
            } catch (error) {
                console.error('Firebase initialization error:', error);
                const errorMessage = document.getElementById('error-message');
                if (errorMessage) {
                    errorMessage.textContent = 'Gagal menginisialisasi Firebase. Periksa konfigurasi atau koneksi internet.';
                    errorMessage.style.display = 'block';
                }
                return;
            }

            // Initialize AOS
            try {
                AOS.init({ once: true });
                console.log('AOS initialized');
            } catch (error) {
                console.error('AOS initialization error:', error);
                const errorMessage = document.getElementById('error-message');
                if (errorMessage) {
                    errorMessage.textContent = 'Gagal memuat animasi. Periksa koneksi internet.';
                    errorMessage.style.display = 'block';
                }
            }

            // Variables
            let newsData = [];
            let opinionData = [];
            let currentPage = 1;
            let currentOpiniPage = 1;
            const itemsPerPage = 5;
            const apiKey = 'YOUR_API_KEY'; // Ganti dengan API key NewsAPI Anda

            // Hero Background
            const heroSection = document.querySelector('.hero-section');
            if (heroSection) {
                const heroBackground = localStorage.getItem('heroBackground');
                if (heroBackground) {
                    heroSection.style.backgroundImage = `url(${heroBackground})`;
                }
            }

            // Fetch News
            async function fetchNews(category = '', subcategory = '') {
                const articleList = document.getElementById('article-list');
                if (!articleList) {
                    console.error('Article list element not found');
                    const errorMessage = document.getElementById('error-message');
                    if (errorMessage) {
                        errorMessage.textContent = 'Terjadi kesalahan pada struktur halaman.';
                        errorMessage.style.display = 'block';
                    }
                    return;
                }
                articleList.innerHTML = '<div class="loading-spinner">Memuat berita...</div>';
                try {
                    console.log(`Fetching news for category: ${category}, subcategory: ${subcategory}`);
                    let url = `https://newsapi.org/v2/top-headlines?country=id&apiKey=${apiKey}`;
                    if (subcategory && subcategory !== 'Opini') {
                        url = `https://newsapi.org/v2/everything?q=${subcategory.toLowerCase()}&language=id&apiKey=${apiKey}`;
                    }
                    const response = await fetch(url);
                    if (!response.ok) throw new Error(`NewsAPI request failed: ${response.statusText}`);
                    const data = await response.json();
                    const realtimeNews = data.articles
                        .filter(article => article.title && article.description && article.url)
                        .map(article => ({
                            id: `realtime-${Date.now()}-${Math.random()}`,
                            title: article.title,
                            description: article.description,
                            url: article.url,
                            urlToImage: article.urlToImage || 'https://via.placeholder.com/80x80?text=No+Image',
                            views: Math.floor(Math.random() * 1000) + 100,
                            category: category || 'Nasional',
                            subcategory: subcategory || 'General',
                            createdAt: new Date()
                        }));
                    console.log(`Fetched ${realtimeNews.length} articles from NewsAPI`);

                    let localNews = [];
                    try {
                        const newsSnapshot = await db.collection('news').get();
                        localNews = newsSnapshot.docs.map(doc => ({
                            id: doc.id,
                            ...doc.data(),
                            createdAt: doc.data().createdAt.toDate()
                        })).filter(n => n.subcategory !== 'Opini');
                        console.log(`Fetched ${localNews.length} articles from Firestore`);
                    } catch (error) {
                        console.error('Firestore fetch error:', error);
                    }

                    newsData = [...realtimeNews, ...localNews];
                    localStorage.setItem('newsDataCache', JSON.stringify(localNews));
                    renderArticles();
                    generateSitemap(); // Generate sitemap after fetching news
                } catch (error) {
                    console.error('Error fetching news:', error);
                    newsData = JSON.parse(localStorage.getItem('newsDataCache')) || [
                        { id: 'dummy1', title: "Satu Tahun Prabowo-Gibran", description: "Laporan tentang capaian pemerintahan.", url: "#", urlToImage: "https://via.placeholder.com/80x80?text=Topik1", views: 1000, category: "Nasional", subcategory: "Ekonomi", createdAt: new Date() },
                        { id: 'dummy2', title: "Dana Daerah Mengendap", description: "Analisis keuangan daerah.", url: "#", urlToImage: "https://via.placeholder.com/80x80?text=Topik2", views: 800, category: "Daerah", subcategory: "Ekonomi", createdAt: new Date() },
                        { id: 'dummy3', title: "Hari Santri 2025", description: "Perayaan dan maknanya.", url: "#", urlToImage: "https://via.placeholder.com/80x80?text=Topik3", views: 600, category: "Nasional", subcategory: "Pendidikan", createdAt: new Date() }
                    ];
                    articleList.innerHTML = '<p class="error-message">Gagal memuat berita dari NewsAPI. Menampilkan data lokal.</p>';
                    renderArticles();
                    generateSitemap();
                }
            }

            // Fetch Opinions
            async function fetchOpinions() {
                const opiniList = document.getElementById('opini-list');
                if (!opiniList) {
                    console.error('Opini list element not found');
                    const errorMessage = document.getElementById('error-message');
                    if (errorMessage) {
                        errorMessage.textContent = 'Terjadi kesalahan pada struktur halaman.';
                        errorMessage.style.display = 'block';
                    }
                    return;
                }
                opiniList.innerHTML = '<div class="loading-spinner">Memuat opini...</div>';
                try {
                    console.log('Fetching opinions from Firestore');
                    const snapshot = await db.collection('opinions').get();
                    opinionData = snapshot.docs.map(doc => ({
                        id: doc.id,
                        ...doc.data(),
                        createdAt: doc.data().createdAt.toDate()
                    }));
                    localStorage.setItem('opinionDataCache', JSON.stringify(opinionData));
                    console.log(`Fetched ${opinionData.length} opinions from Firestore`);
                    renderOpini();
                    generateSitemap(); // Generate sitemap after fetching opinions
                } catch (error) {
                    console.error('Error fetching opinions:', error);
                    opinionData = JSON.parse(localStorage.getItem('opinionDataCache')) || [
                        { id: 'opini1', title: "Opini: Masa Depan Ekonomi Indonesia", description: "Pandangan tentang pertumbuhan ekonomi.", url: "#", urlToImage: "https://via.placeholder.com/80x80?text=Opini1", views: 500, createdAt: new Date() },
                        { id: 'opini2', title: "Opini: Reformasi Pendidikan", description: "Tantangan dan solusi pendidikan.", url: "#", urlToImage: "https://via.placeholder.com/80x80?text=Opini2", views: 400, createdAt: new Date() }
                    ];
                    opiniList.innerHTML = '<p class="error-message">Gagal memuat opini dari Firestore. Menampilkan data lokal.</p>';
                    renderOpini();
                    generateSitemap();
                }
            }

            // Render Articles
            function renderArticles() {
                const articleList = document.getElementById('article-list');
                if (!articleList) {
                    console.error('Article list element not found');
                    return;
                }
                const startIndex = (currentPage - 1) * itemsPerPage;
                const endIndex = startIndex + itemsPerPage;
                const paginatedData = newsData.slice(startIndex, endIndex);
                articleList.innerHTML = paginatedData.length ? '' : '<p class="error-message">Belum ada berita tersedia.</p>';
                paginatedData.forEach((article, index) => {
                    const card = document.createElement('div');
                    card.className = 'article-card d-flex';
                    card.setAttribute('data-aos', 'fade-up');
                    card.setAttribute('data-aos-delay', index * 100);
                    card.innerHTML = `
                        <img src="${article.urlToImage}" alt="${article.title} - Portal Berita Dinamis" class="me-3" onerror="this.src='https://via.placeholder.com/80x80?text=No+Image';">
                        <div>
                            <h3 class="mb-1"><a href="${article.url}" class="text-dark text-decoration-none">${article.title}</a></h3>
                            <p class="text-muted small">${article.description || 'Deskripsi tidak tersedia.'}</p>
                            <p class="text-muted small">Dibaca: ${article.views || 0} kali | Kategori: ${article.category} - ${article.subcategory}</p>
                        </div>
                    `;
                    articleList.appendChild(card);
                });
                renderPagination();
            }

            // Render Opini
            function renderOpini() {
                const opiniList = document.getElementById('opini-list');
                if (!opiniList) {
                    console.error('Opini list element not found');
                    return;
                }
                const startIndex = (currentOpiniPage - 1) * itemsPerPage;
                const endIndex = startIndex + itemsPerPage;
                const paginatedData = opinionData.slice(startIndex, endIndex);
                opiniList.innerHTML = paginatedData.length ? '' : '<p class="error-message">Belum ada opini tersedia.</p>';
                paginatedData.forEach((article, index) => {
                    const card = document.createElement('div');
                    card.className = 'article-card d-flex';
                    card.setAttribute('data-aos', 'fade-up');
                    card.setAttribute('data-aos-delay', index * 100);
                    card.innerHTML = `
                        <img src="${article.urlToImage}" alt="${article.title} - Opini Portal Berita Dinamis" class="me-3" onerror="this.src='https://via.placeholder.com/80x80?text=No+Image';">
                        <div>
                            <h3 class="mb-1"><a href="${article.url}" class="text-dark text-decoration-none">${article.title}</a></h3>
                            <p class="text-muted small">${article.description || 'Deskripsi tidak tersedia.'}</p>
                            <p class="text-muted small">Dibaca: ${article.views || 0} kali</p>
                        </div>
                    `;
                    opiniList.appendChild(card);
                });
                renderOpiniPagination();
            }

            // Render Pagination
            function renderPagination() {
                const pagination = document.getElementById('pagination');
                if (!pagination) {
                    console.error('Pagination element not found');
                    return;
                }
                const totalPages = Math.ceil(newsData.length / itemsPerPage);
                pagination.innerHTML = '';
                if (totalPages <= 1) return;
                for (let i = 1; i <= totalPages; i++) {
                    const li = document.createElement('li');
                    li.className = `page-item ${i === currentPage ? 'active' : ''}`;
                    li.innerHTML = `<a class="page-link" href="#" onclick="changePage(${i})" aria-label="Halaman ${i}">${i}</a>`;
                    pagination.appendChild(li);
                }
            }

            function renderOpiniPagination() {
                const pagination = document.getElementById('opini-pagination');
                if (!pagination) {
                    console.error('Opini pagination element not found');
                    return;
                }
                const totalPages = Math.ceil(opinionData.length / itemsPerPage);
                pagination.innerHTML = '';
                if (totalPages <= 1) return;
                for (let i = 1; i <= totalPages; i++) {
                    const li = document.createElement('li');
                    li.className = `page-item ${i === currentOpiniPage ? 'active' : ''}`;
                    li.innerHTML = `<a class="page-link" href="#" onclick="changeOpiniPage(${i})" aria-label="Halaman Opini ${i}">${i}</a>`;
                    pagination.appendChild(li);
                }
            }

            // Change Page
            window.changePage = function(page) {
                currentPage = page;
                renderArticles();
            };

            window.changeOpiniPage = function(page) {
                currentOpiniPage = page;
                renderOpini();
            };

            // Filter by Category
            window.filterByCategory = function(category, subcategory) {
                console.log(`Filtering by category: ${category}, subcategory: ${subcategory}`);
                const filteredNews = newsData.filter(article =>
                    (category ? article.category === category : true) &&
                    (subcategory ? article.subcategory === subcategory : true)
                );
                newsData = filteredNews;
                currentPage = 1;
                renderArticles();
            };

            // Search Functionality
            const searchForm = document.querySelector('.search-form');
            if (searchForm) {
                searchForm.addEventListener('submit', (e) => {
                    e.preventDefault();
                    const query = document.getElementById('searchInput')?.value.toLowerCase();
                    if (!query) {
                        fetchNews();
                        return;
                    }
                    console.log(`Searching for: ${query}`);
                    const filteredNews = newsData.filter(article =>
                        article.title.toLowerCase().includes(query) ||
                        article.description.toLowerCase().includes(query)
                    );
                    newsData = filteredNews;
                    currentPage = 1;
                    renderArticles();
                });
            }

            // Dropdown Hover
            const dropdowns = document.querySelectorAll('.dropdown-submenu');
            dropdowns.forEach(dropdown => {
                dropdown.addEventListener('mouseenter', function() {
                    this.querySelector('.dropdown-menu').classList.add('show');
                });
                dropdown.addEventListener('mouseleave', function() {
                    this.querySelector('.dropdown-menu').classList.remove('show');
                });
            });

            // Navbar Scroll Effect
            window.addEventListener('scroll', () => {
                const navbar = document.getElementById('navbar');
                if (navbar) {
                    navbar.classList.toggle('scrolled', window.scrollY > 50);
                }
            });

            // Generate Sitemap
            function generateSitemap() {
                const sitemap = `<?xml version="1.0" encoding="UTF-8"?>
<urlset xmlns="http://www.sitemaps.org/schemas/sitemap/0.9">
    <url>
        <loc>https://yourdomain.com</loc>
        <lastmod>${new Date().toISOString()}</lastmod>
        <changefreq>daily</changefreq>
        <priority>1.0</priority>
    </url>
    <url>
        <loc>https://yourdomain.com/#about</loc>
        <lastmod>${new Date().toISOString()}</lastmod>
        <changefreq>monthly</changefreq>
        <priority>0.8</priority>
    </url>
    ${newsData.map(article => `
    <url>
        <loc>${article.url}</loc>
        <lastmod>${new Date(article.createdAt).toISOString()}</lastmod>
        <changefreq>weekly</changefreq>
        <priority>0.7</priority>
    </url>`).join('')}
    ${opinionData.map(opini => `
    <url>
        <loc>${opini.url}</loc>
        <lastmod>${new Date(opini.createdAt).toISOString()}</lastmod>
        <changefreq>weekly</changefreq>
        <priority>0.7</priority>
    </url>`).join('')}
</urlset>`;
                console.log('Generated sitemap:', sitemap);
                // Simpan sitemap ke server (contoh menggunakan Blob untuk download lokal)
                const blob = new Blob([sitemap], { type: 'text/xml' });
                const link = document.createElement('a');
                link.href = URL.createObjectURL(blob);
                link.download = 'sitemap.xml';
                // Untuk produksi, upload sitemap ke server menggunakan API atau backend
                console.log('Sitemap generated. In production, upload to /sitemap.xml');
            }

            // Load Data
            fetchNews();
            fetchOpinions();
        });
    </script>
</body>
</html>
